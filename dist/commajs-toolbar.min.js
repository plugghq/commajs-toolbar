!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CommaToolbar=t():e.CommaToolbar=t()}(window,function(){return o={},l.m=n=[function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return m});n(0);function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var l=function(){function l(e,t,n){r(this,l),this.onChangeCallback=n;var o=document.createElement("div");o.style.position="absolute",o.style.zIndex="99999",o.style.border="1px solid #e1e1e1",o.style.borderRadius="2px",o.style.backgroundColor="#f9f9f9",o.style.padding="4px",o.style.left=e,o.style.top=t,o.style.outline="none",o.setAttribute("tabindex","3333"),o.addEventListener("blur",function(){this.parentNode.removeChild(this)}),this.canvas=document.createElement("canvas"),this.width=200,this.height=140,this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.cursor="pointer",this.context=this.canvas.getContext("2d"),this.pickerCircle={x:10,y:10,width:7,height:7},this.draw(),o.appendChild(this.canvas),this.previewbox=document.createElement("div"),this.previewbox.style.width="200px",this.previewbox.style.height="14px",this.previewbox.style.backgroundColor="rgba(0,0,0,0)",o.appendChild(this.previewbox),this.listenForEvents(),document.body.appendChild(o),o.focus(),this.panel=o}return i(l,[{key:"draw",value:function(){this.build()}},{key:"build",value:function(){var e=this.context.createLinearGradient(0,0,this.width,0);e.addColorStop(0,"rgb(255, 0, 0)"),e.addColorStop(.15,"rgb(255, 0, 255)"),e.addColorStop(.33,"rgb(0, 0, 255)"),e.addColorStop(.49,"rgb(0, 255, 255)"),e.addColorStop(.67,"rgb(0, 255, 0)"),e.addColorStop(.84,"rgb(255, 255, 0)"),e.addColorStop(1,"rgb(255, 0, 0)"),this.context.fillStyle=e,this.context.fillRect(0,0,this.width,this.height),(e=this.context.createLinearGradient(0,0,0,this.height)).addColorStop(0,"rgba(255, 255, 255, 1)"),e.addColorStop(.5,"rgba(255, 255, 255, 0)"),e.addColorStop(.5,"rgba(0, 0, 0, 0)"),e.addColorStop(1,"rgba(0, 0, 0, 1)"),this.context.fillStyle=e,this.context.fillRect(0,0,this.width,this.height),this.context.beginPath(),this.context.arc(this.pickerCircle.x,this.pickerCircle.y,this.pickerCircle.width,0,2*Math.PI),this.context.strokeStyle="#ffffff",this.context.stroke(),this.context.closePath()}},{key:"listenForEvents",value:function(){var l=this;this.canvas.addEventListener("mousemove",function(e){var t=l.canvas.getBoundingClientRect(),n=e.clientX-t.left,o=e.clientY-t.top;l.pickerCircle.x=n,l.pickerCircle.y=o,l.previewbox.style.backgroundColor=l.getPickedColor(),l.draw()}),this.canvas.addEventListener("click",function(){return l.SelectColor()})}},{key:"getPickedColor",value:function(){var e=this.context.getImageData(this.pickerCircle.x,this.pickerCircle.y,1,1);return"#"+this.fullColorHex(e.data[0],e.data[1],e.data[2])}},{key:"SelectColor",value:function(){try{this.panel.parentNode.removeChild(this.panel)}catch(e){}this.onChangeCallback(this.getPickedColor())}},{key:"rgbToHex",value:function(e){var t=Number(e).toString(16);return t.length<2&&(t="0"+t),t}},{key:"fullColorHex",value:function(e,t,n){return this.rgbToHex(e)+this.rgbToHex(t)+this.rgbToHex(n)}}]),l}(),s=function(){function a(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,l=4<arguments.length&&void 0!==arguments[4]?arguments[4]:void 0,i=5<arguments.length&&void 0!==arguments[5]&&arguments[5],s=6<arguments.length&&void 0!==arguments[6]&&arguments[6];r(this,a),this.event=e,this.callBack=t,this.preserveFocus=s,this.keepOnAfterSelection=i,this.addToLeft=n,this.addToTop=o,this.selectedColor=this._parseSelectedColor(l),this.usedCustomColors=[],"undefined"!=typeof Storage&&(this.usedCustomColors=JSON.parse(localStorage.getItem("usedCustomColors")),null==this.usedCustomColors&&(this.usedCustomColors=[])),this._showColorPalette()}return i(a,[{key:"_parseSelectedColor",value:function(e){var t,n=e;return null!=e&&-1<e.toLowerCase().indexOf("rgb")&&(t=(e=e.toLowerCase()).split("(")[1].split(")")[0].split(","),n="#"+this._rgbToHex(t[0].split(" ").join(""))+this._rgbToHex(t[1].split(" ").join(""))+this._rgbToHex(t[2].split(" ").join(""))),n}},{key:"_rgbToHex",value:function(e){var t=Number(e).toString(16);return t.length<2&&(t="0"+t),t}},{key:"_showColorPalette",value:function(){var n=this,o=document.createElement("div");o.style.position="absolute",o.style.zIndex="99999",o.style.border="1px solid #e1e1e1",o.style.borderRadius="2px",o.style.backgroundColor="#f9f9f9",o.style.padding="4px 4px 0px 0px",o.style.outline="none",o.setAttribute("tabindex","123");var e=this.event.srcElement.getBoundingClientRect();o.style.left=e.left+parseInt(this.addToLeft)+"px",o.style.top=parseInt(this.addToTop)+window.scrollY+e.height+e.top+"px";var t=[];t.push(["#dfb9b1","#eecdcd","#f8e5d0","#fdf2d0","#dce9d5","#d3dfe2","#ccdaf5","#d2e1f1","#d8d2e7","#e6d2db"]),t.push(["#d08270","#de9c9b","#f2cca2","#fbe5a3","#bcd5ac","#a9c3c8","#a9c2f0","#a6c4e5","#b2a8d2","#cea8bc"]),t.push(["#bd4b31","#d16d6a","#ecb476","#ffefa1","#9dc284","#80a4ad","#779ee5","#7ba7d7","#8b7ebe","#b87f9e"]),t.push(["#982a15","#bb261a","#da944b","#eac251","#78a55a","#53808c","#4a79d1","#4f85c1","#6351a2","#9b5378"]),t.push(["#7a2817","#8c1a11","#a96324","#b89130","#48742c","#264e5b","#2657c5","#24538f","#312071","#6b2346"]);var l=document.createElement("div");l.style.display="flex",l.style.marginTop="2px",l.style.marginBottom="6px",["#000000","#39434d","#666666","#999999","#b7b7b7","#cccccc","#d9d9d9","#efefef","#ffffff","TRANSPARENT"].forEach(function(e){var t=n._getDomCell_colorPicker(e,o);l.appendChild(t)}),o.appendChild(l),t.forEach(function(e){(l=document.createElement("div")).style.display="flex",e.forEach(function(e){var t=n._getDomCell_colorPicker(e,o);l.appendChild(t)}),o.appendChild(l)});var i,s=document.createElement("div");s.style.display="flex",s.style.justifyContent="center",s.style.alignItems="center",s.style.cursor="pointer",s.style.fontFamily="Arial",s.style.padding="2px 4px 2px 4px",s.style.fontSize="14px",s.style.color="#999999",s.textContent="Custom",s.addEventListener("mouseover",function(){this.style.color="#30b7e8"}),s.addEventListener("mouseout",function(){this.style.color="#999999"}),s.addEventListener("click",function(){n.pnl.style.display="none",n.ShowCustomPanel()}),o.appendChild(s),0<this.usedCustomColors.length?((i=document.createElement("div")).style.display="flex",i.style.marginTop="2px",i.style.marginBottom="0px",this.usedCustomColors.forEach(function(e){var t=n._getDomCell_colorPicker(e,o);i.appendChild(t)}),o.appendChild(i)):s.style.padding="2px 4px 4px 4px",o.addEventListener("blur",function(){n.keepOnAfterSelection||this.parentNode.removeChild(this)}),document.body.appendChild(o),o.focus(),this.pnl=o}},{key:"_getDomCell_colorPicker",value:function(e){var t,n=this,o=e,l=this.selectedColor,i=void 0;return"TRANSPARENT"==e?((i=document.createElement("canvas")).width=13,i.height=13,i.style.border="2px solid #ffffff",i.style.margin="0px 0px 4px 4px ",i.style.borderRadius="2px",(t=i.getContext("2d")).fillStyle="#ffffff",t.fillRect(0,0,i.width,i.height),t.strokeStyle="#FF0000",t.lineWidth=2,t.beginPath(),t.moveTo(0,13),t.lineTo(13,0),t.stroke()):((i=document.createElement("div")).style.width="13px",i.style.height="13px",i.style.backgroundColor=o,i.style.margin="0px 0px 4px 4px ",i.style.borderRadius="2px",i.style.border=l==o?"2px solid #30b7e8":"2px solid "+o),i.addEventListener("mouseover",function(){this.style.cursor="pointer",this.style.border="2px solid #30b7e8"}),i.addEventListener("mouseout",function(){this.style.border=o!=l?"TRANSPARENT"==o?"2px solid #ffffff":"2px solid "+o:"2px solid #30b7e8"}),i.addEventListener("click",function(){if(n.callBack(o),!n.keepOnAfterSelection)try{n.pnl.parentNode.removeChild(n.pnl)}catch(e){}}),this.preserveFocus&&i.addEventListener("mousedown",function(e){e.preventDefault()}),i}},{key:"ShowCustomPanel",value:function(){var t=this;new l(this.pnl.style.left,this.pnl.style.top,function(e){t.usedCustomColors.indexOf(e)<0&&(t.usedCustomColors.push(e),10<t.usedCustomColors.length&&t.usedCustomColors.shift(),localStorage.setItem("usedCustomColors",JSON.stringify(t.usedCustomColors))),t.callBack(e),null===t.pnl.parentNode||t.pnl.parentNode.removeChild(t.pnl)})}}]),a}();function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var d=function(){function o(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.toolbar=e,this.Init(t,n)}var e,t,n;return e=o,(t=[{key:"KeepFocusOnEditor",value:function(e){this.toolbar.KeepFocusOnEditor(e)}},{key:"InsertPlugin",value:function(e,t){this.toolbar.InsertPlugin(e,t)}},{key:"Init",value:function(e,t){var n=this;this.tableType=t,this.addTablePnl=void 0,this.addTablePnlCurrentRow=void 0,this.addTablePnlCurrentCol=void 0,this.addTablePnlMinDimension=5,this.moPrevCol=0,this.moPrevRow=0;var o=document.createElement("div");o.style.position="absolute",o.style.zIndex="99999",o.style.border="1px solid #e1e1e1",o.style.borderRadius="2px",o.style.backgroundColor="#f9f9f9",o.style.padding="2px",o.style.display="block",o.style.outline="none",o.setAttribute("tabindex","0");var l=e.srcElement.getBoundingClientRect();o.style.left=l.left+window.scrollX-50+"px",o.style.top=6+l.height+l.top+ +window.scrollY+"px";for(var i=document.createElement("div"),s=0;s<this.addTablePnlMinDimension;){var a=document.createElement("div");a.setAttribute("trow",s),a.style.display="flex";for(var r=0;r<this.addTablePnlMinDimension;)this._addCellToTableRow(a),r++;i.appendChild(a),s++}o.addEventListener("blur",function(){n.addTablePnl=void 0,o.parentNode.removeChild(o)}),o.appendChild(i);var d=document.createElement("div");d.style.padding="4px 4px 2px 4px",d.style.textAlign="center",d.style.fontSize="12px",d.style.color="#7f8082";var u=document.createElement("span");u.innerText="0",d.appendChild(u),this.addTablePnlCurrentCol=u;var c=document.createElement("span");c.appendChild(document.createTextNode(" x ")),d.appendChild(c);var p=document.createElement("span");p.innerText="0",d.appendChild(p),this.addTablePnlCurrentRow=p,o.appendChild(d),document.body.appendChild(o),o.focus(),this.addTablePnl=i}},{key:"_addCellToTableRow",value:function(e){var l=this,t=document.createElement("div");t.style.margin="1px",t.style.border="1px solid #c1c1c1",t.style.borderRadius="2px",t.style.backgroundColor="#ffffff",t.style.cursor="pointer",t.style.width="12px",t.style.height="12px",t.setAttribute("tcol",e.childNodes.length),t.setAttribute("trow",e.getAttribute("trow")),t.addEventListener("mousedown",function(e){l.KeepFocusOnEditor(e)}),t.addEventListener("click",function(){var e=parseInt(this.getAttribute("tcol"))+1,t=parseInt(this.getAttribute("trow"))+1;l.InsertPlugin(l.tableType,{rows:t,cols:e})}),t.addEventListener("mouseover",function(e){var t=parseInt(this.getAttribute("tcol")),n=parseInt(this.getAttribute("trow"));l._highlightTableCells(n,t);var o=l.addTablePnlMinDimension-1;o<=t&&t>l.moPrevCol?l._tableColManager("add"):o-1<=t&&t<l.moPrevCol&&l._tableColManager("remove"),o<=n&&n>l.moPrevRow?l._tableRowManager("add"):o-1<=n&&n<l.moPrevRow&&l._tableRowManager("remove"),l.moPrevCol=t,l.moPrevRow=n}),e.appendChild(t)}},{key:"_tableColManager",value:function(t){var n=this;this.addTablePnl.childNodes.forEach(function(e){"add"==t?n._addCellToTableRow(e):e.removeChild(e.lastChild)})}},{key:"_tableRowManager",value:function(e){if("add"==e){var t=this.addTablePnl.childNodes.length,n=document.createElement("div");n.setAttribute("trow",t),n.style.display="flex";for(var o=this.addTablePnl.firstChild.childNodes.length,l=0;l<o;)this._addCellToTableRow(n),l++;this.addTablePnl.appendChild(n)}else this.addTablePnl.removeChild(this.addTablePnl.lastChild)}},{key:"_highlightTableCells",value:function(o,l){this._updateLabelsTableDimenstion(o,l);var i=0;this.addTablePnl.childNodes.forEach(function(e){var t=!1;i<=o&&(t=!0);var n=0;e.childNodes.forEach(function(e){e.style.border=t&&n<=l?"1px solid #30b7e8":"1px solid #c1c1c1",n++}),i++})}},{key:"_updateLabelsTableDimenstion",value:function(e,t){null!=this.addTablePnlCurrentRow&&(this.addTablePnlCurrentRow.innerText=parseInt(e)+1),null!=this.addTablePnlCurrentCol&&(this.addTablePnlCurrentCol.innerText=parseInt(t)+1)}}])&&a(e.prototype,t),n&&a(e,n),o}();function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var c=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.toolbar=e,this.Render(t)}var e,t,o;return e=n,(t=[{key:"KeepFocusOnEditor",value:function(e){this.toolbar.KeepFocusOnEditor(e)}},{key:"StoreCursorPosition",value:function(){this.toolbar.StoreCursorPosition()}},{key:"RestoreCursorPosition",value:function(){this.toolbar.RestoreCursorPosition()}},{key:"InsertPlugin",value:function(e,t){this.toolbar.InsertPlugin(e,t)}},{key:"Render",value:function(e){var n=this;n.StoreCursorPosition();var t=document.getSelection(),o=!0,o=!!t.isCollapsed,l=document.createElement("div");l.style.position="absolute",l.style.zIndex="99999",l.style.border="1px solid #e1e1e1",l.style.borderRadius="2px",l.style.backgroundColor="#f9f9f9",l.style.padding="6px",l.style.overflow="hidden",l.style.outline="none";var i=e.srcElement.getBoundingClientRect();l.style.left=i.left-100+"px",l.style.top=6+i.height+i.top+"px";var s,a,r=void 0;o&&((s=document.createElement("div")).style.display="flex",s.style.alignItems="center",s.style.marginBottom="4px",(a=document.createElement("div")).style.fontSize="14px",a.style.width="30px",a.style.color="#7f8082",a.innerText="Text ",s.appendChild(a),(r=document.createElement("input")).style.border="1px solid #e1e1e1",r.style.borderRadius="2px",r.style.fontSize="12px",r.style.color="#57595e",r.style.padding="4px",r.style.outline="none",r.addEventListener("keydown",function(e){"Esc"!=e.key&&"Escape"!=e.key||(n.RestoreCursorPosition(),l.parentNode.removeChild(l))}),r.addEventListener("focus",function(e){n.isFocusOnLabel=!0,n.isFocusOnUrl=!1}),r.addEventListener("blur",function(e){n.isFocusOnLabel=!1,setTimeout(function(){n.isFocusOnUrl||null!=l.parentNode&&(n.RestoreCursorPosition(),l.parentNode.removeChild(l))},200)}),s.appendChild(r),l.appendChild(s));var d=document.createElement("div");d.style.display="flex",d.style.alignItems="center",d.style.marginBottom="4px";var u=document.createElement("div");u.style.fontSize="14px",u.style.width="30px",u.style.color="#7f8082",u.innerText="Link ",d.appendChild(u);var c=document.createElement("input");c.style.border="1px solid #e1e1e1",c.style.borderRadius="2px",c.style.fontSize="12px",c.style.color="#57595e",c.style.padding="4px",c.style.outline="none",c.addEventListener("keydown",function(e){"Esc"!=e.key&&"Escape"!=e.key||(n.RestoreCursorPosition(),l.parentNode.removeChild(l))}),c.addEventListener("focus",function(e){n.isFocusOnLabel=!1,n.isFocusOnUrl=!0}),c.addEventListener("blur",function(e){n.isFocusOnUrl=!1,setTimeout(function(){n.isFocusOnLabel||null!=l.parentNode&&(n.RestoreCursorPosition(),l.parentNode.removeChild(l))},200)}),d.appendChild(c),l.appendChild(d);var p=document.createElement("div");p.style.display="flex",p.style.justifyContent="flex-end";var h=document.createElement("div");h.style.fontSize="14px",h.style.color="#7f8082",h.style.textAlign="center",h.style.cursor="pointer",h.style.padding="4px",h.style.border="1px solid #f9f9f9",h.innerText="Apply",h.addEventListener("mouseover",function(e){this.style.color="#FF9100"}),h.addEventListener("mouseout",function(e){this.style.color="#7f8082"}),h.addEventListener("click",function(e){var t={};t.url=c.value,t.label="",o&&(t.label=r.value),n.RestoreCursorPosition(),n.InsertPlugin("link",t)}),p.appendChild(h),l.appendChild(p),document.body.appendChild(l),c.focus()}}])&&u(e.prototype,t),o&&u(e,o),n}();function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var h=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.toolbar=e,this.Render(t)}var e,t,o;return e=n,(t=[{key:"KeepFocusOnEditor",value:function(e){this.toolbar.KeepFocusOnEditor(e)}},{key:"StoreCursorPosition",value:function(){this.toolbar.StoreCursorPosition()}},{key:"RestoreCursorPosition",value:function(){this.toolbar.RestoreCursorPosition()}},{key:"InsertPlugin",value:function(e,t){this.toolbar.InsertPlugin(e,t)}},{key:"Render",value:function(e){var n=this;n.StoreCursorPosition();var t=document.createElement("div");t.style.position="absolute",t.style.zIndex="99999",t.style.border="1px solid #e1e1e1",t.style.borderRadius="2px",t.style.backgroundColor="#f9f9f9",t.style.padding="6px",t.style.overflow="hidden",t.style.outline="none";var o=e.srcElement.getBoundingClientRect();t.style.left=window.scrollX+o.left-100+"px",t.style.top=6+window.scrollY+o.height+o.top+"px";var l=document.createElement("div");l.style.display="flex",l.style.alignItems="center",l.style.marginBottom="4px";var i=document.createElement("div");i.style.fontSize="14px",i.style.width="114px",i.style.color="#7f8082",i.innerText="Split document in ",l.appendChild(i);var s=document.createElement("input");s.style.border="1px solid #e1e1e1",s.style.borderRadius="2px",s.style.fontSize="12px",s.style.color="#57595e",s.style.padding="4px",s.style.width="20px",s.style.outline="none",s.value=2,s.addEventListener("keydown",function(e){"Esc"!=e.key&&"Escape"!=e.key||(n.RestoreCursorPosition(),t.parentNode.removeChild(t))}),s.addEventListener("focus",function(e){n.isFocusOnLabel=!1,n.isFocusOnUrl=!0}),s.addEventListener("blur",function(e){n.isFocusOnUrl=!1,setTimeout(function(){n.isFocusOnLabel||null!=t.parentNode&&(n.RestoreCursorPosition(),t.parentNode.removeChild(t))},200)}),l.appendChild(s);var a=document.createElement("div");a.style.fontSize="14px",a.style.width="60px",a.style.color="#7f8082",a.innerHTML="&nbsp;columns",l.appendChild(a),t.appendChild(l);var r=document.createElement("div");r.style.display="flex",r.style.justifyContent="flex-end";var d=document.createElement("div");d.style.fontSize="14px",d.style.color="#7f8082",d.style.textAlign="center",d.style.cursor="pointer",d.style.padding="8px 4px 4px 4px",d.style.border="1px solid #f9f9f9",d.innerText="Apply",d.addEventListener("mouseover",function(e){this.style.color="#FF9100"}),d.addEventListener("mouseout",function(e){this.style.color="#7f8082"}),d.addEventListener("click",function(e){var t={};t.cols=parseInt(s.value),n.RestoreCursorPosition(),n.InsertPlugin("multiColumns",t)}),r.appendChild(d),t.appendChild(r),document.body.appendChild(t),s.focus()}}])&&p(e.prototype,t),o&&p(e,o),n}();function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var y=function(){function i(e,t,n,o,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.toolbar=e,this.btn=t,this.values=n,this.currentValue=o,this.onClick=l,this.Render()}var e,t,n;return e=i,(t=[{key:"StoreCursorPosition",value:function(){this.toolbar.StoreCursorPosition()}},{key:"RestoreCursorPosition",value:function(){this.toolbar.RestoreCursorPosition()}},{key:"Destroy",value:function(){try{this.pnl.parentNode.removeChild(this.pnl)}catch(e){}}},{key:"Render",value:function(){var n=this;this.StoreCursorPosition();var o=document.createElement("div");o.style.position="absolute",o.style.zIndex="99999999",o.style.border="1px solid #e1e1e1",o.style.borderRadius="2px",o.style.backgroundColor="#f9f9f9",o.style.padding="0px",o.style.overflow="auto",o.style.outline="none",o.style.display="block",o.setAttribute("tabindex","123");var e=this.btn.getBoundingClientRect();o.style.left=window.scrollX+e.left+"px",o.style.top=window.scrollY+e.height+e.top+"px",o.style.maxHeight="120px",o.addEventListener("blur",function(e){o.parentNode.removeChild(o),n.RestoreCursorPosition()}),this.values.forEach(function(e){var t=document.createElement("div");t.classList.add("cm-toolbar-select-label"),e.value==n.currentValue&&t.classList.add("cm-toolbar-select-label-selected"),t.textContent=e.label,t.addEventListener("click",function(){n.RestoreCursorPosition(),n.onClick(e.value)}),o.appendChild(t)}),document.body.appendChild(o),o.focus(),this.pnl=o}}])&&f(e.prototype,t),n&&f(e,n),i}();function v(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var b=["separator","outline","bold","italic","underlined","strike","fontSize","fontFamily","fontColor","backgroundColor","align-left","align-center","align-right","align-justify","indent","dedent","numbered-list","list","horizontal-rule","table","spreadsheet","superscript","subscript","links","tasks","multi-columns","stickynotes","fileUpload","code"],m=function(){function o(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.commaInstance=e,this.idContainer=t,this.options=n,this.options.defaultStyle=this.commaInstance.GetStyleAtCarret(),this.currentStyle=void 0,this.Render(),this.CalculateCurrentStyle(this.commaInstance.GetStyleAtCarret())}var e,t,n;return e=o,(t=[{key:"Render",value:function(){var n=this,o=document.getElementById(this.idContainer);o.classList.add("cm-toolbar-container"),null!=this.options.style&&"small"==this.options.style&&(o.style.padding="2px 0px",o.style.margin="0px"),o.innerHTML="&nbsp;";var e=["outline","separator","bold","italic","underlined","strike","separator","fontSize","fontFamily","separator","fontColor","backgroundColor","separator","align-left","align-center","align-right","align-justify","separator","indent","dedent","separator","numbered-list","list","separator","horizontal-rule","table","spreadsheet","superscript","subscript","links","tasks","multi-columns","stickynotes","fileUpload","code"],t=this.options.buttons;"all"==t?t=e:"mini"==t?t=["bold","italic","underlined","strike","separator","fontSize","fontFamily","fontColor","separator","numbered-list","list","separator","table","spreadsheet","separator","links","tasks","stickynotes"]:null!=t&&""!=t||(t=e),t.forEach(function(e){var t;"string"==typeof e?"separator"==e?((t=document.createElement("div")).classList.add("cm-toolbar-separator"),o.appendChild(t)):"outline"==e?(o.appendChild(n.CreateButton(e)),o.appendChild(n.CreateNewOutlineButton())):"fontSize"==e?o.appendChild(n.CreateFontSizeButton()):"fontFamily"==e?o.appendChild(n.CreateFontFamilyButton()):o.appendChild(n.CreateButton(e)):o.appendChild(n.AddCustomButton(e))})}},{key:"GenerateNewButtonId",value:function(e){null==this.allMenuButtons&&(this.allMenuButtons={});var t="cmTooolBtn"+Object.keys(this.allMenuButtons).length+1;return this.allMenuButtons[e]=t}},{key:"CreateButton",value:function(e){var t=this,n=document.createElement("div");n.classList.add("cm-toolbar-button"),n.setAttribute("id",this.GenerateNewButtonId(e));var o=e,l=document.createElement("i");l.classList.add("fa");var i=void 0;return"outline"==o?(n.title="Table Of Contents",l.classList.add("fa-bars"),i=function(){t.CallPluginStaticMethod("outline","OpenNavigationPanel")}):"bold"==o?(n.title="Bold",l.classList.add("fa-bold"),i=function(){t.ToggleStyleOnSelection("bold")}):"italic"==o?(n.title="Italic",l.classList.add("fa-italic"),i=function(){t.ToggleStyleOnSelection("italic")}):"underlined"==o?(n.title="Underlined",l.classList.add("fa-underline"),i=function(){t.ToggleStyleOnSelection("underlined")}):"strike"==o?(n.title="Strikethrough",l.classList.add("fa-strikethrough"),i=function(){t.ToggleStyleOnSelection("strike")}):"fontColor"==o?(n.title="Font Color",l.classList.add("fa-tint"),i=function(e){t.OpenPickFontColorPanel(e)}):"backgroundColor"==o?(n.title="Background Color",l.classList.add("fa-paint-brush"),i=function(e){t.OpenPickBgColorPanel(e)}):"align-left"==o?(n.title="Align Left",l.classList.add("fa-align-left"),i=function(){t.ToggleStyleOnLine("align","left")}):"align-center"==o?(n.title="Align Center",l.classList.add("fa-align-center"),i=function(){t.ToggleStyleOnLine("align","center")}):"align-right"==o?(n.title="Align Right",l.classList.add("fa-align-right"),i=function(){t.ToggleStyleOnLine("align","right")}):"align-justify"==o?(n.title="Align Justify",l.classList.add("fa-align-justify"),i=function(){t.ToggleStyleOnLine("align","justify")}):"indent"==o?(n.title="Indent",l.classList.add("fa-indent"),i=function(){t.ToggleStyleOnLine("indent","add")}):"dedent"==o?(n.title="Dedent",l.classList.add("fa-dedent"),i=function(){t.ToggleStyleOnLine("indent","subtract")}):"numbered-list"==o?(n.title="Numbered List",l.classList.add("fa-list-ol"),i=function(){t.InsertPlugin("lists","numbered")}):"list"==o?(n.title="List",l.classList.add("fa-list-ul"),i=function(){t.InsertPlugin("lists","bulleted")}):"horizontal-rule"==o?(n.title="Horizontal Rule",l.classList.add("fa-minus"),i=function(){t.InsertPlugin("horizontalRule")}):"table"==o?(n.title="Table",l.classList.add("fa-table"),i=function(e){t.OpenAddTable(e,"table")}):"spreadsheet"==o?(n.title="Spreadsheet",l.classList.add("fa-file-excel-o"),i=function(e){t.OpenAddTable(e,"spreadsheet")}):"superscript"==o?(n.title="Superscript",l.classList.add("fa-superscript"),i=function(){console.log("superscript"),t.ToggleStyleOnSelection("superscript")}):"subscript"==o?(n.title="Subscript",l.classList.add("fa-subscript"),i=function(){t.ToggleStyleOnSelection("subscript")}):"links"==o?(n.title="Link",l.classList.add("fa-link"),i=function(e){t.OpenAddLink(e)}):"tasks"==o?(n.title="Tasks",l.classList.add("fa-check-square"),i=function(){t.InsertPlugin("tasks")}):"multi-columns"==o?(n.title="Multi columns document",l.classList.add("fa-columns"),i=function(e){t.OpenPickNumberOfColumns(e)}):"stickynotes"==o?(n.title="Stickynote",l.classList.add("fa-sticky-note"),i=function(e){t.OpenPickStickyNoteBgColorPanel(e)}):"fileUpload"==o?(n.title="Upload File",l.classList.add("fa-upload"),i=function(){t.OpenFileUpload()}):"code"==o&&(n.title="Code",l.classList.add("fa-code"),i=function(){t.InsertPlugin("code")}),n.addEventListener("mousedown",this.KeepFocusOnEditor),n.addEventListener("click",i),n.appendChild(l),n}},{key:"AddCustomButton",value:function(e){null==this.customBtnCounter&&(this.customBtnCounter=0),this.customBtnCounter++;var t=document.createElement("div");t.classList.add("cm-toolbar-button"),t.setAttribute("id",this.GenerateNewButtonId("custom"+this.customBtnCounter)),t.title=e.title;var n=document.createElement("i");return n.classList.add("fa"),t.addEventListener("mousedown",this.KeepFocusOnEditor),t.addEventListener("click",e.onClick),n.classList.add(e.faIcon),t.appendChild(n),t}},{key:"CreateFontSizeButton",value:function(){var t=this,e=document.createElement("div");e.classList.add("cm-toolbar-button"),e.classList.add("cm-toolbar-label-button"),e.setAttribute("id",this.GenerateNewButtonId("fontSize")),e.title="Font Size";var n=document.createElement("div");n.style.marginRight="4px",n.textContent="12px",e.appendChild(n);var o=document.createElement("i");return o.classList.add("fa"),o.classList.add("fa-caret-down"),e.appendChild(o),e.addEventListener("mousedown",this.KeepFocusOnEditor),e.addEventListener("click",function(e){t.OpenFontSizePanel(e)}),this.fontSizeButton=e}},{key:"OpenFileUpload",value:function(){var l=document.createElement("input");l.type="file",l.style.display="none";var i=this.options.onUploadFiles;l.addEventListener("change",function(){for(var e=this.files,t=[],n=0,o=e.length;n<o;n++)t.push(e[n]);null!=i&&i(t),l.parentElement.removeChild(l)}),document.body.appendChild(l),l.click()}},{key:"CreateFontFamilyButton",value:function(){var t=this,e=document.createElement("div");e.classList.add("cm-toolbar-button"),e.classList.add("cm-toolbar-label-button"),e.setAttribute("id",this.GenerateNewButtonId("fontFamily")),e.title="Font Family";var n=document.createElement("div");n.style.marginRight="4px",n.style.whiteSpace="nowrap",n.style.width="56px",n.style.overflow="hidden",n.textContent="Verdana",e.appendChild(n);var o=document.createElement("i");return o.classList.add("fa"),o.classList.add("fa-caret-down"),e.appendChild(o),e.addEventListener("mousedown",this.KeepFocusOnEditor),e.addEventListener("click",function(e){t.OpenFontFamilyPanel(e)}),this.fontFamilyButton=e}},{key:"CreateNewOutlineButton",value:function(){var t=this,e=document.createElement("div");e.classList.add("cm-toolbar-button"),e.classList.add("cm-toolbar-label-button"),e.setAttribute("id",this.GenerateNewButtonId("outlineSelect")),e.title="Table of Contents";var n=document.createElement("div");n.style.marginRight="4px",n.style.whiteSpace="nowrap",n.style.width="70px",n.style.overflow="hidden",n.textContent="Normal",e.appendChild(n);var o=document.createElement("i");return o.style.display="block",o.classList.add("fa"),o.classList.add("fa-caret-down"),e.appendChild(o),e.addEventListener("mousedown",this.KeepFocusOnEditor),e.addEventListener("click",function(e){t.OpenOutlinePanel(e)}),this.outlineButton=e}},{key:"CalculateCurrentStyle",value:function(s){var a=this;this.currentStyle=s,b.forEach(function(e){var t,n,o,l,i=a.allMenuButtons[e];null!=i&&""!=i&&((t=document.getElementById(i)).className=t.className.replace(" cm-toolbar-button-selected",""),"fontColor"==e||"backgroundColor"==e?null!=a.options.defaultStyle&&("fontColor"==e?(n=a.allMenuButtons[e],l=document.getElementById(n),null!=a.options.defaultStyle.fontColor?l.firstChild.style.color=a.options.defaultStyle.fontColor:l.firstChild.style.color="#39434d"):"backgroundColor"==e&&(o=a.allMenuButtons[e],l=document.getElementById(o),null!=a.options.defaultStyle.backgroundColor?l.firstChild.style.color=a.options.defaultStyle.backgroundColor:l.firstChild.style.color="#5e626b")):"outline"==e&&(a.outlineButton.firstChild.textContent="Normal"))}),null!=s&&(null!=s.nodeStyle&&Object.keys(s.nodeStyle).forEach(function(e){var t,n,o,l,i=s.nodeStyle[e];"style"==i.applyAs?i.isToggle?null!=(t=a.allMenuButtons[e])&&""!=t&&null!=(l=document.getElementById(t))&&(l.className=l.className+" cm-toolbar-button-selected"):null!=(n=a.allMenuButtons[e])&&""!=n&&null!=(l=document.getElementById(n))&&("fontColor"==e||"backgroundColor"==e?l.firstChild.style.color=i.on:"fontFamily"==e?a.fontFamilyButton.firstChild.textContent=i.on.replace(/'/g,""):"fontSize"==e&&(a.fontSizeButton.firstChild.textContent=i.on)):"class"==i.applyAs&&(!i.isToggle||null!=(o=a.allMenuButtons[e])&&""!=o&&null!=(l=document.getElementById(o))&&(l.className=l.className+" cm-toolbar-button-selected"),"headerone"==e.toLowerCase()?a.outlineButton.firstChild.textContent="Header 1":"headertwo"==e.toLowerCase()?a.outlineButton.firstChild.textContent="Header 2":"headerthree"==e.toLowerCase()?a.outlineButton.firstChild.textContent="Header 3":a.outlineButton.firstChild.textContent="Normal")}),null!=s.lineStyle&&Object.keys(s.lineStyle).forEach(function(e){var t,n,o=s.lineStyle[e];"style"==o.applyAs&&o.isToggle&&(null==(t=a.allMenuButtons[e+"-"+o.on])||""==t||null!=(n=document.getElementById(t))&&(n.className=n.className+" cm-toolbar-button-selected"))}))}},{key:"KeepFocusOnEditor",value:function(e){null!=this.currentOpenSelect&&this.currentOpenSelect.Destroy(),e.preventDefault()}},{key:"StoreCursorPosition",value:function(){this.commaInstance.StoreCursorPosition()}},{key:"RestoreCursorPosition",value:function(){this.commaInstance.RestoreCursorPosition()}},{key:"InsertPlugin",value:function(e,t){this.commaInstance.InsertPluginAtSection(e,t)}},{key:"CallPluginStaticMethod",value:function(e,t,n){this.commaInstance.CallPluginStaticMethod(e,t,n)}},{key:"ToggleStyleOnSelection",value:function(e,t){this.commaInstance.ToggleStyleOnSelection(e,t)}},{key:"ToggleStyleOnLine",value:function(e,t){this.commaInstance.ToggleStyleOnLine(e,t)}},{key:"OpenPickFontColorPanel",value:function(e){this.ShowColorPalette("fontColor",e)}},{key:"OpenPickBgColorPanel",value:function(e){this.ShowColorPalette("backgroundColor",e)}},{key:"OpenPickStickyNoteBgColorPanel",value:function(e){this.ShowColorPalette("stickyNote",e)}},{key:"OpenPickNumberOfColumns",value:function(e){new h(this,e)}},{key:"ShowColorPalette",value:function(e,t){var n=this;this.changeColorAction=e;var o="";"fontColor"==this.changeColorAction?null!=this.currentStyle.nodeStyle&&null!=this.currentStyle.nodeStyle.fontColor&&(o=this.currentStyle.nodeStyle.fontColor.on):"backgroundColor"==e&&null!=this.currentStyle.nodeStyle&&null!=this.currentStyle.nodeStyle.backgroundColor&&(o=this.currentStyle.nodeStyle.backgroundColor.on),this.StoreCursorPosition();new s(t,function(e){n.ChangeColor(e)},-80,6,o)}},{key:"ChangeColor",value:function(e){this.RestoreCursorPosition(),"fontColor"==this.changeColorAction?this.ToggleStyleOnSelection("fontColor",e):"backgroundColor"==this.changeColorAction?this.ToggleStyleOnSelection("backgroundColor",e):"stickyNote"==this.changeColorAction&&this.InsertPlugin("stickynote",{bgColor:e})}},{key:"OpenAddTable",value:function(e,t){new d(this,e,t)}},{key:"OpenAddLink",value:function(e){new c(this,e)}},{key:"OpenFontSizePanel",value:function(){var t=this,e=[{label:"10px",value:"10px"},{label:"12px",value:"12px"},{label:"14px",value:"14px"},{label:"16px",value:"16px"},{label:"18px",value:"18px"},{label:"20px",value:"20px"},{label:"22px",value:"22px"},{label:"26px",value:"26px"},{label:"30px",value:"30px"},{label:"36px",value:"36px"},{label:"50px",value:"50px"},{label:"80px",value:"80px"}];null!=this.options.fontSizes&&0<this.options.fontSizes.length&&(e=this.options.fontSizes),null!=this.currentOpenSelect&&this.currentOpenSelect.Destroy();var n="";null!=this.currentStyle&&null!=this.currentStyle.nodeStyle&&null!=this.currentStyle.nodeStyle.fontSize&&null!=this.currentStyle.nodeStyle.fontSize.on&&(n=this.currentStyle.nodeStyle.fontSize.on),this.currentOpenSelect=new y(this,this.fontSizeButton,e,n,function(e){t.ToggleStyleOnSelection("fontSize",e)})}},{key:"OpenFontFamilyPanel",value:function(){var t=this,e=[{label:"Times New Roman",value:"'Times New Roman'"},{label:"Georgia",value:"Georgia"},{label:"Palatino",value:"Palatino"},{label:"Arial Black",value:"'Arial Black'"},{label:"Comic Sans MS",value:"Comic Sans MS"},{label:"Lucida Sans Unicode",value:"'Lucida Sans Unicode'"},{label:"Tahoma",value:"Tahoma"},{label:"Trebuchet MS",value:"'Trebuchet MS'"},{label:"Verdana",value:"Verdana"},{label:"Courier New",value:"'Courier New'"},{label:"Lucida Console",value:"'Lucida Console'"}];null!=this.options.fontFamilies&&0<this.options.fontFamilies.length&&(e=this.options.fontFamilies);var n="";null!=this.currentStyle&&null!=this.currentStyle.nodeStyle&&null!=this.currentStyle.nodeStyle.fontFamily&&null!=this.currentStyle.nodeStyle.fontFamily.on&&(n=this.currentStyle.nodeStyle.fontFamily.on),null!=this.currentOpenSelect&&this.currentOpenSelect.Destroy(),this.currentOpenSelect=new y(this,this.fontFamilyButton,e,n,function(e){t.ToggleStyleOnSelection("fontFamily",e)})}},{key:"OpenOutlinePanel",value:function(){var t=this;null!=this.currentStyle&&null!=this.currentStyle.nodeStyle&&null!=this.currentStyle.nodeStyle.outline&&null!=this.currentStyle.nodeStyle.outline.on&&(currentFont=this.currentStyle.nodeStyle.outline.on),null!=this.currentOpenSelect&&this.currentOpenSelect.Destroy(),this.currentOpenSelect=new y(this,this.outlineButton,[{label:"Heading 1",value:"h1"},{label:"Heading 2",value:"h2"},{label:"Heading 3",value:"h3"},{label:"Normal",value:"normal"}],"",function(e){t.InsertPlugin("outline",e)})}}])&&v(e.prototype,t),n&&v(e,n),o}()}],l.c=o,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)l.d(n,o,function(e){return t[e]}.bind(null,o));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/",l(l.s=1);function l(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,l),t.l=!0,t.exports}var n,o});